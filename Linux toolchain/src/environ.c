#include <stdio.h>
#include <stdlib.h>

extern char **environ;

int main(int argc, char **argv) {
    int foo = 1;

    // The first argument argv[0] is the invocation path of the
    // executable.
    //
    // Even with address space randomization disabled, command-line
    // arguments affect the memory location of the stack.

    for (int i = 0; i < argc; i++) {
        printf("argv[%d] @ %p = %s\n", i, argv[i], argv[i]);
    }

    // Environment variables are placed after command-line arguments.
    //
    // They also affect the stack placement.

    for (int i = 0; environ[i]; i++) {
        printf("environ[%d] @ %p = %s\n", i, environ[i], environ[i]);
    }

    // Changes to command-line arguments and/or environment variables
    // move the stack variable.

    printf("foo @ %p = %d\n", &foo, foo);
}
