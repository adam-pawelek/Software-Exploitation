CC       = gcc
CFLAGS  += -std=c11 -g -Wall -Werror \
           -O0 -m32 -no-pie \
           -fno-stack-protector \
           -z execstack -z norelro \
           -D_FORTIFY_SOURCE=0 \
           -mpreferred-stack-boundary=2
TARGETS  = $(patsubst %.c,%,$(wildcard *.c))

all: $(TARGETS)

clean:
	rm -f $(TARGETS)
	rm -f *.o

stack_frames: LDFLAGS += -ldl
stack_frames: CFLAGS += -finstrument-functions -rdynamic
stack_frames: stack_frames.o
	$(CC) $(CFLAGS) $^ -o $@ $(LDFLAGS)

stack_1: CFLAGS += -Wno-deprecated-declarations -Wno-unused-variable
